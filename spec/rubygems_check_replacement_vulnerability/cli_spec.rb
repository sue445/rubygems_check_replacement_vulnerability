describe RubygemsCheckReplacementVulnerability::CLI do
  subject { RubygemsCheckReplacementVulnerability::CLI.start(args) }

  let(:args) { [command] }

  describe "#vulnerable_gems" do
    let(:command) { "vulnerable_gems" }

    let(:args) { [command, "--username=sue445", "--format=plain"] }

    it { expect { subject }.not_to raise_error }
  end

  describe "#verify_gem" do
    let(:command) { "verify_gem" }

    let(:args) { [command, "--name=faker-precure", "--version=0.0.3", "--repo-url=git://github.com/sue445/faker-precure.git"] }

    it { expect { subject }.not_to raise_error }
  end
end
