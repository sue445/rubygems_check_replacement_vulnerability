describe RubygemsCheckReplacementVulnerability::Repository do
  include_context "uses temp dir"

  let(:repository) { RubygemsCheckReplacementVulnerability::Repository.new(repo_url, work_dir) }
  let(:repo_url)   { "git://github.com/sue445/rubicure.git" }
  let(:work_dir)   { temp_dir }

  describe "#git_clone" do
    subject! { repository.git_clone }

    it_is_asserted_by { File.exists?("#{work_dir}/rubicure.gemspec") }
  end

  describe "#tags" do
    subject { repository.tags }

    before do
      repository.git_clone
    end

    it { should include "v0.1.4" }
  end

  describe "#checkout" do
    before do
      repository.git_clone
    end

    subject! { repository.checkout(hash) }

    let(:hash) { "v0.1.4" }

    it_is_asserted_by { File.read("#{work_dir}/lib/rubicure/version.rb").include?(%q{VERSION = "0.1.4"}) }
  end
end
